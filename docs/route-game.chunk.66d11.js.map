{"version":3,"sources":["webpack:///./routes/game/questions.js","webpack:///./routes/game/index.js"],"names":["questions","getShuffledQuestions","array","i","length","j","Math","floor","random","Profile","state","timer","time","gameState","questionIndex","nexting","startGame","stopGame","setState","GAMETIME","window","setTimeout","tick","requestAccelerometer","clearTimeout","tada","stopAccelerometer","next","ding","move","event","angleMatches","abs","gamma","DeviceOrientationEvent","requestPermission","then","response","startAccelerometer","catch","console","error","addEventListener","removeEventListener","playSound","document","getElementById","audio","pause","currentTime","play","renderEndState","class","type","onClick","renderPendingState","renderRunningState","question","renderStartingState","componentWillUnmount","this","render","props","Component"],"mappings":"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","file":"route-game.chunk.66d11.js","sourcesContent":["export const questions = [\n\t'Gripe',\n\t'Covid 19',\n\t'Pnemonia'\n];\n\nexport const getShuffledQuestions = () => {\n\tconst array = [...questions];\n\tfor (let i = array.length - 1; i > 0; i--) {\n\t\tlet j = Math.floor(Math.random() * (i + 1));\n\t\t[array[i], array[j]] = [array[j], array[i]];\n\t}\n\treturn array;\n};\n","import { h, Component } from 'preact';\nimport { getShuffledQuestions } from './questions';\n\nconst GAMETIME = 60;\nconst COUNTDOWN = 3;\nconst DEGREES = 15;\nconst USE_ACCELEROMETER = true;\n\nexport default class Profile extends Component {\n\tstate = {\n\t\ttimer: null,\n\t\ttime: null,\n\t\tgameState: 'pending',\n\t\tquestionIndex: 0,\n\t\tquestions: [],\n\t\tnexting: false\n\t};\n\n\tstartGame = () => {\n\t\tif (this.state.gameState === 'running') {\n\t\t\tthis.stopGame('restarting');\n\t\t}\n\n\t\tthis.setState(\n\t\t\t{\n\t\t\t\tgameState: 'starting',\n\t\t\t\ttime: GAMETIME + COUNTDOWN,\n\t\t\t\ttimer: window.setTimeout(this.tick, 1000),\n\t\t\t\tquestions: getShuffledQuestions(),\n\t\t\t\tquestionIndex: 0\n\t\t\t},\n\t\t\tthis.requestAccelerometer\n\t\t);\n\t};\n\n\tstopGame = (gameState = 'ended') => {\n\t\tif (this.state.timer) {\n\t\t\twindow.clearTimeout(this.state.timer);\n\t\t}\n\n\t\tthis.setState(\n\t\t\t{\n\t\t\t\tgameState,\n\t\t\t\ttime: null,\n\t\t\t\ttimer: null\n\t\t\t},\n\t\t\t() => {\n\t\t\t\tthis.tada();\n\t\t\t\tthis.stopAccelerometer();\n\t\t\t}\n\t\t);\n\t};\n\n\ttick = () => {\n\t\tif (this.state.time) {\n\t\t\tconst readyToStart = this.state.time - GAMETIME === 1;\n\t\t\tif (readyToStart) {\n\t\t\t\tthis.setState({ gameState: 'running' });\n\t\t\t}\n\n\t\t\tthis.setState({\n\t\t\t\ttime: this.state.time - 1,\n\t\t\t\ttimer: window.setTimeout(this.tick, 1000)\n\t\t\t});\n\t\t} else {\n\t\t\tthis.stopGame();\n\t\t}\n\t};\n\n\tnext = () => {\n\t\tthis.setState(\n\t\t\t({ questionIndex }) => ({\n\t\t\t\tquestionIndex: questionIndex + 1\n\t\t\t}),\n\t\t\tthis.ding\n\t\t);\n\t};\n\n\tmove = event => {\n\t\tconst angle = Math.abs(event.gamma);\n\t\tconst angleMatches = angle < DEGREES;\n\t\tconst { nexting, gameState } = this.state;\n\n\t\tif (angleMatches && !nexting && gameState === 'running') {\n\t\t\tthis.setState({ nexting: true }, this.next);\n\t\t} else if (!angleMatches && nexting) {\n\t\t\tthis.setState({ nexting: false });\n\t\t}\n\t};\n\n\trequestAccelerometer = () => {\n\t\tif (!USE_ACCELEROMETER) {\n\t\t\treturn;\n\t\t}\n\n\t\tif (\n\t\t\ttypeof DeviceOrientationEvent !== 'undefined' &&\n\t\t\ttypeof DeviceOrientationEvent.requestPermission === 'function'\n\t\t) {\n\t\t\tDeviceOrientationEvent.requestPermission()\n\t\t\t\t.then(response => {\n\t\t\t\t\tif (response === 'granted') {\n\t\t\t\t\t\tthis.startAccelerometer();\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t\t.catch(console.error);\n\t\t} else {\n\t\t\tthis.startAccelerometer();\n\t\t}\n\t};\n\n\tstartAccelerometer = () => {\n\t\twindow.addEventListener('deviceorientation', this.move, true);\n\t};\n\n\tstopAccelerometer = () => {\n\t\twindow.removeEventListener('deviceorientation', this.move, true);\n\t};\n\n\tding = () => {\n\t\tthis.playSound(document.getElementById('ding'));\n\t};\n\n\ttada = () => {\n\t\tthis.playSound(document.getElementById('tada'));\n\t};\n\n\tplaySound = audio => {\n\t\tif (!audio) return;\n\t\taudio.pause();\n\t\taudio.currentTime = 0;\n\t\taudio.play();\n\t};\n\n\tcomponentWillUnmount() {\n\t\tthis.stopAccelerometer();\n\t}\n\n\trenderEndState = () => {\n\t\treturn (\n\t\t\t<div class=\"game game--ended\">\n\t\t\t\t<h2>Acabou o Tempo!</h2>\n\t\t\t\t<button type=\"button\" class=\"button\" onClick={() => this.startGame()}>\n\t\t\t\t\tJogar de novo\n\t\t\t\t</button>\n\t\t\t</div>\n\t\t);\n\t};\n\n\trenderPendingState = () => {\n\t\treturn (\n\t\t\t<div class=\"game game--pending\">\n\t\t\t\t<h2>Pronto para começar?</h2>\n\t\t\t\t<button type=\"button\" class=\"button\" onClick={() => this.startGame()}>\n\t\t\t\t\tIniciar\n\t\t\t\t</button>\n\t\t\t</div>\n\t\t);\n\t};\n\n\trenderRunningState = () => {\n\t\tconst { time, questions, questionIndex } = this.state;\n\t\tconst question = questions[questionIndex];\n\n\t\treturn (\n\t\t\t<div class=\"game game--running\">\n\t\t\t\t<h2 class=\"question\">{question || <span>&nbsp;</span>}</h2>\n\t\t\t\t<time>{time}</time>\n\t\t\t\t<div>\n\t\t\t\t\t<button\n\t\t\t\t\t\ttype=\"button\"\n\t\t\t\t\t\tclass=\"button button--small\"\n\t\t\t\t\t\tonClick={() => this.next()}\n\t\t\t\t\t>\n\t\t\t\t\t\tPróximo\n\t\t\t\t\t</button>\n\t\t\t\t\t<button\n\t\t\t\t\t\ttype=\"button\"\n\t\t\t\t\t\tclass=\"button button--small\"\n\t\t\t\t\t\tonClick={() => this.stopGame()}\n\t\t\t\t\t>\n\t\t\t\t\t\tParar\n\t\t\t\t\t</button>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t);\n\t};\n\n\trenderStartingState = () => {\n\t\tconst time = this.state.time - GAMETIME;\n\n\t\treturn (\n\t\t\t<div class=\"game game--starting\">\n\t\t\t\t<h2>Iniciando em: {time}</h2>\n\t\t\t</div>\n\t\t);\n\t};\n\n\trender(props, { gameState, time, questions, questionIndex }) {\n\t\tswitch (gameState) {\n\t\t\tcase 'ended':\n\t\t\t\treturn this.renderEndState();\n\t\t\tcase 'pending':\n\t\t\t\treturn this.renderPendingState();\n\t\t\tcase 'starting':\n\t\t\t\treturn this.renderStartingState();\n\t\t\tcase 'running':\n\t\t\t\treturn this.renderRunningState();\n\t\t}\n\n\t\treturn null;\n\t}\n}\n"],"sourceRoot":""}